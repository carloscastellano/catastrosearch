!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=1)}([function(module,exports,__webpack_require__){"use strict";var namespace=function(_namespace){return function(target){var namespaceArray=_namespace.split("."),mainPath=namespaceArray[0];window[mainPath]||(window[mainPath]={}),function constructObject(namespaceArray,obj){if(namespaceArray.length>0){var name=namespaceArray[0];obj[name]||(obj[name]={}),constructObject(namespaceArray.splice(1),obj[name])}else obj[target.name]=target;return obj}(namespaceArray.splice(1),window[mainPath])}};module.exports=namespace},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _dec,_class,_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_decorator=__webpack_require__(0),_decorator2=_interopRequireDefault(_decorator),_catastrosearchControl=__webpack_require__(2),_catastrosearch=(_interopRequireDefault(_catastrosearchControl),__webpack_require__(4));_interopRequireDefault(_catastrosearch),(_dec=(0,_decorator2.default)("M.plugin"))(_class=function(_M$Plugin){function CatastroSearch(parameters){_classCallCheck(this,CatastroSearch),parameters=parameters||{};var _this=_possibleConstructorReturn(this,(CatastroSearch.__proto__||Object.getPrototypeOf(CatastroSearch)).call(this,parameters));return _this.map_=null,_this.control_=null,_this.panel_=null,_this.params_={},M.utils.isNullOrEmpty(parameters.params)||(_this.params_=parameters.params),_this.options_={},M.utils.isNullOrEmpty(parameters.options)||(_this.options_=parameters.options),_this}return _inherits(CatastroSearch,_M$Plugin),_createClass(CatastroSearch,[{key:"addTo",value:function(map){var _this2=this;this.map_=map,this.control_=new M.control.CatastroSearchControl,this.panel_=new M.ui.Panel("catastrosearch",{collapsible:!0,className:"m-catastrosearch",collapsedButtonClass:"g-cartografia-localizacion3",position:M.ui.position.TR,tooltip:"Búsqueda catastral"}),this.panel_.on(M.evt.ADDED_TO_MAP,function(html){M.utils.enableTouchScroll(html)}),this.panel_.addControls(this.control_),this.map_.addPanels(this.panel_),this.control_.on(M.evt.ADDED_TO_MAP,function(){_this2.fire(M.evt.ADDED_TO_MAP)})}},{key:"destroy",value:function(){this.map_.removeControls([this.control_]),this.map_=null,this.control_=null,this.panel_=null,this.options_=null}},{key:"equals",value:function(plugin){return plugin instanceof CatastroSearch}}]),CatastroSearch}(M.Plugin))},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.CatastroSearchControl=void 0;var _dec,_class,_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_decorator=__webpack_require__(0),_decorator2=_interopRequireDefault(_decorator),_catastrosearchControl=__webpack_require__(3);_interopRequireDefault(_catastrosearchControl),exports.CatastroSearchControl=(_dec=(0,_decorator2.default)("M.control"))(_class=function(_M$Control){function CatastroSearchControl(){_classCallCheck(this,CatastroSearchControl),M.utils.isUndefined(M.impl.control.CatastroSearchControl)&&M.exception("La implementación usada no puede crear controles CatastroSearchControl");var impl=new M.impl.control.CatastroSearchControl,_this=_possibleConstructorReturn(this,(CatastroSearchControl.__proto__||Object.getPrototypeOf(CatastroSearchControl)).call(this,impl,"CatastroSearch"));return _this.inputsTabs_=null,_this.selectedTab_="",_this.inputParcel_=null,_this.inputPolygon_=null,_this.selectMunicipality_=null,_this.selectProvince_=null,_this.inputReference_=null,_this.provincias_=["ALMERIA","CADIZ","CORDOBA","GRANADA","HUELVA","JAEN","MALAGA","SEVILLA"],_this}return _inherits(CatastroSearchControl,_M$Control),_createClass(CatastroSearchControl,[{key:"addEvents",value:function(html){var _this2=this;this.loadBtn_=html.querySelector(".button > button.load"),this.clearBtn_=html.querySelector(".button > button.clear"),this.selectProvince_=html.querySelector(".form div.province > select"),this.selectMunicipality_=html.querySelector(".form div.municipality > select"),this.inputParcel_=html.querySelector(".form div.parcel > input"),this.inputPolygon_=html.querySelector(".form div.polygon > input"),this.inputReference_=html.querySelector(".form div.reference > input"),this.inputsTabs_=html.querySelectorAll('input[name="tabs-catastro"]'),this.selectedTab_=html.querySelector('input[name="tabs-catastro"]:checked').dataset.tab,this.clearBtn_.addEventListener("click",function(evt){return _this2.clearInputs()}),this.loadBtn_.addEventListener("click",function(evt){return _this2.getRC()}),this.selectProvince_.addEventListener("change",function(evt){return _this2.changeProvince(evt)}),this.selectMunicipality_.addEventListener("change",function(evt){return _this2.changeMunicipality(evt)}),this.inputParcel_.addEventListener("input",function(evt){return _this2.checkButtons(evt)}),this.inputPolygon_.addEventListener("input",function(evt){return _this2.checkButtons(evt)}),this.inputReference_.addEventListener("input",function(evt){return _this2.checkButtons(evt)}),this.inputsTabs_.forEach(function(element){element.addEventListener("change",function(evt){return _this2.changeTab(evt)})})}},{key:"getRC",value:function(){"referencia"==this.selectedTab_?(this.rc_=this.inputReference_.value,this.rc_.length>14&&(this.rc_=this.rc_.slice(0,14)),this.getCoordinatesRC()):this.getRCFromPP()}},{key:"changeTab",value:function(evt){evt=evt||window.event;var itemTarget=evt.target;this.selectedTab_=itemTarget.dataset.tab,this.checkButtons()}},{key:"createView",value:function(map){var _this3=this;return new Promise(function(success,fail){M.template.compile("catastrosearch.html",{vars:{provincias:_this3.provincias_}}).then(function(html){_this3.addEvents(html),success(html)})})}},{key:"checkButtons",value:function(){"referencia"==this.selectedTab_?(this.clearBtn_.disabled=M.utils.isNullOrEmpty(this.inputReference_.value),this.loadBtn_.disabled=M.utils.isNullOrEmpty(this.inputReference_.value)):(this.clearBtn_.disabled=M.utils.isNullOrEmpty(this.selectProvince_.value)&&M.utils.isNullOrEmpty(this.selectMunicipality_.value)&&M.utils.isNullOrEmpty(this.inputPolygon_.value)&&M.utils.isNullOrEmpty(this.inputParcel_.value),this.loadBtn_.disabled=M.utils.isNullOrEmpty(this.selectProvince_.value)||M.utils.isNullOrEmpty(this.selectMunicipality_.value)||M.utils.isNullOrEmpty(this.inputPolygon_.value)||M.utils.isNullOrEmpty(this.inputParcel_.value))}},{key:"clearInputs",value:function(){"referencia"==this.selectedTab_?this.inputReference_.value="":(this.inputPolygon_.value="",this.inputParcel_.value="",this.selectProvince_.value="",this.selectMunicipality_.value=""),this.checkButtons(),this.getImpl().clearCoordinatesLayer()}},{key:"changeProvince",value:function(evt){this.checkButtons(),this.getMunicipios()}},{key:"changeMunicipality",value:function(evt){this.checkButtons()}},{key:"getMunicipios",value:function(){var _this4=this;"referencia"==this.selectedTab_&&(this.rc_=this.inputReference_.value);M.remote.get("http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejero.asmx/ConsultaMunicipio",{Provincia:this.selectProvince_.value,Municipio:""},{jsonp:!0}).then(function(response){var parser=new DOMParser,xmlDoc=parser.parseFromString(response.text,"text/xml"),error=xmlDoc.getElementsByTagName("error");if(_this4.selectMunicipality_.innerHTML=null,_this4.createMunicipalityOption_("Municipio...",""),error.length)M.dialog.error("Error al consultar al catastro: "+error[0].childNodes[0].nodeValue);else for(var municipios=xmlDoc.getElementsByTagName("nm"),i=0;i<municipios.length;i++){var name=municipios[i].childNodes[0].nodeValue;_this4.createMunicipalityOption_(name,name)}})}},{key:"createMunicipalityOption_",value:function(name,value){var opt=document.createElement("option");opt.value=value,opt.innerHTML=name,this.selectMunicipality_.appendChild(opt)}},{key:"getCoordinatesRC",value:function(){var _this5=this;M.remote.get("http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCoordenadas.asmx/Consulta_CPMRC",{Provincia:"",Municipio:"",SRS:"EPSG:4326",RC:this.rc_},{jsonp:!0}).then(function(response){var parser=new DOMParser,xmlDoc=parser.parseFromString(response.text,"text/xml"),error=xmlDoc.getElementsByTagName("des");if(error.length)M.dialog.error(error[0].childNodes[0].nodeValue);else{var xCoord=xmlDoc.getElementsByTagName("xcen")[0].childNodes[0].nodeValue,yCoord=xmlDoc.getElementsByTagName("ycen")[0].childNodes[0].nodeValue;_this5.getImpl().clearCoordinatesLayer(),_this5.getImpl().addCoordToMap(xCoord,yCoord,"EPSG:4326"),_this5.getImpl().centerLayer()}})}},{key:"getRCFromPP",value:function(){var _this6=this;M.remote.get("http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejero.asmx/Consulta_DNPPP",{Provincia:this.selectProvince_.value,Municipio:this.selectMunicipality_.value,Poligono:this.inputPolygon_.value,Parcela:this.inputParcel_.value},{jsonp:!0}).then(function(response){var parser=new DOMParser,xmlDoc=parser.parseFromString(response.text,"text/xml"),error=xmlDoc.getElementsByTagName("des");if(error.length)M.dialog.info(error[0].childNodes[0].nodeValue);else{var pc1=xmlDoc.getElementsByTagName("pc1"),pc2=xmlDoc.getElementsByTagName("pc2");_this6.rc_=pc1[0].childNodes[0].nodeValue+pc2[0].childNodes[0].nodeValue,_this6.getCoordinatesRC()}})}}]),CatastroSearchControl}(M.Control))||_class},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.CatastroSearchControl=void 0;var _dec,_class,_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_decorator=__webpack_require__(0),_decorator2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_decorator);exports.CatastroSearchControl=(_dec=(0,_decorator2.default)("M.impl.control"))(_class=function(_M$impl$Control){function CatastroSearchControl(){_classCallCheck(this,CatastroSearchControl);var _this=_possibleConstructorReturn(this,(CatastroSearchControl.__proto__||Object.getPrototypeOf(CatastroSearchControl)).call(this));return _this.layer_=new M.layer.Vector({name:"Catastro_Coordinates"},{displayInLayerSwitcher:!1}),_this}return _inherits(CatastroSearchControl,_M$impl$Control),_createClass(CatastroSearchControl,[{key:"addTo",value:function(map,html){this.facadeMap_=map,this.element=html,map.addLayers(this.layer_);var olMap=map.getMapImpl();ol.control.Control.call(this,{element:html,target:null}),olMap.addControl(this)}},{key:"activate",value:function(){}},{key:"deactivate",value:function(){}},{key:"addCoordToMap",value:function(longitude,latitude,selectedProjection){var coordinates=ol.proj.transform([longitude,latitude],selectedProjection,this.facadeMap_.getProjection().code),feature=new M.Feature(null,{geometry:{coordinates:coordinates,type:"Point"}});return this.layer_.addFeatures(feature),this.layer_}},{key:"centerLayer",value:function(){var extent=this.layer_.getFeaturesExtent();M.utils.isNullOrEmpty(extent)||this.facadeMap_.getMapImpl().getView().fit(extent,{duration:500,minResolution:1})}},{key:"clearCoordinatesLayer",value:function(){this.layer_.clear()}}]),CatastroSearchControl}(M.impl.Control))||_class},function(module,exports){}]),M.template.add("catastrosearch.html",Handlebars.template({1:function(container,depth0,helpers,partials,data){var alias1=container.lambda,alias2=container.escapeExpression;return'                <option value="'+alias2(alias1(depth0,depth0))+'">'+alias2(alias1(depth0,depth0))+"</option>\r\n"},compiler:[7,">= 4.0.0"],main:function(container,depth0,helpers,partials,data){var stack1;return'<div class="m-control m-catastrosearch-container">\r\n    \x3c!-- TITLE --\x3e\r\n    <div class="title">Búsqueda catastral</div>\r\n\r\n    <input id="tab1" class="tabs" data-tab="referencia" type="radio" name="tabs-catastro" checked>\r\n    <label for="tab1">Referencia</label>\r\n\r\n    <input id="tab2" class="tabs" data-tab="pol_par" type="radio" name="tabs-catastro">\r\n    <label for="tab2">Polígono/Parcela</label>\r\n    <div class="tabs-border"></div>\r\n    \x3c!-- FORM --\x3e\r\n    <div id="content1" class="form catastro">\r\n        \x3c!-- Referencia Catastral --\x3e\r\n        <div class="reference">\r\n            <label>Referencia Catastral</label>\r\n            <input type="text" maxlength="20">\r\n        </div>\r\n    </div>\r\n    \x3c!-- FORM --\x3e\r\n    <div id="content2" class="form catastro">\r\n        \x3c!-- Provincia --\x3e\r\n        <div class="province">\r\n            <label>Provincia</label>\r\n            <select name="provincelist">\r\n                <option value="">Provincia...</option>\r\n'+(null!=(stack1=helpers.each.call(null!=depth0?depth0:container.nullContext||{},null!=depth0?depth0.provincias:depth0,{name:"each",hash:{},fn:container.program(1,data,0),inverse:container.noop,data:data}))?stack1:"")+'            </select>\r\n        </div>\r\n        \x3c!-- Municipio --\x3e\r\n        <div class="municipality">\r\n            <label>Municipio</label>\r\n            <select name="municipalitylist">\r\n                <option value="">Municipio...</option>\r\n            </select>\r\n        </div>\r\n        \x3c!-- Poligono --\x3e\r\n        <div class="polygon">\r\n            <label>Polígono</label>\r\n            <input type="number">\r\n        </div>\r\n        \x3c!-- Parcela --\x3e\r\n        <div class="parcel">\r\n            <label>Parcela</label>\r\n            <input type="number">\r\n        </div>\r\n    </div>\r\n    \x3c!-- buttons --\x3e\r\n    <div class="button">\r\n        <button class="load" title="Buscar coordenada" disabled>\r\n            <i class="g-cartografia-posicion3"></i> Buscar</button>\r\n        <button class="clear" title="Limpiar coordenadas" disabled>\r\n            <i class="g-cartografia-check4"></i> Limpiar</button>\r\n    </div>\r\n</div>'},useData:!0}));